# Reddit → Lemmy Bridge
# Compatible with Lemmy-Ansible 0.19.x and Docker Compose v2+
# Drop this file in /opt/Reddit-Mirror-2-Lemmy/docker-compose.yml

version: "3.8"

services:
  reddit-lemmy-bridge:
    container_name: reddit-lemmy-bridge
    build: .
    restart: unless-stopped
    env_file:
      - .env
    working_dir: /app
    volumes:
      - ./auto_mirror.py:/app/auto_mirror.py:ro
      - ./data:/app/data
    command: ["python", "-u", "auto_mirror.py"]
    networks:
      - lemmy_net
    hostname: reddit-lemmy-bridge

  edit-sync:
    container_name: reddit-lemmy-edit-sync
    build: .
    restart: unless-stopped
    env_file:
      - .env
    working_dir: /app
    volumes:
      - ./edit_sync.py:/app/edit_sync.py:ro
      - ./data:/app/data
    command: ["python", "-u", "edit_sync.py"]
    networks:
      - lemmy_net
    hostname: reddit-lemmy-edit-sync

networks:
  # Attach to Lemmy’s Docker network so “lemmy” resolves correctly
  lemmy_net:
    external: true
    name: EDIT-FOR-YOUR-NETWORK-IF-NEEDED
